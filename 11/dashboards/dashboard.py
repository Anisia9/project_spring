
import streamlit as st
import pandas as pd
import matplotlib.pyplot as plt
import seaborn as sns
import sys
from pathlib import Path

# –î–æ–±–∞–≤–ª—è–µ–º –ø–∞–ø–∫—É /scripts –≤ PYTHONPATH
scripts_path = Path(__file__).parent.parent / "scripts"
sys.path.append(str(scripts_path))

from eda import run_eda
from analyze_distributions import calculate_additional_columns, plot_distribution
from analyze_price_factors import analyze_numeric_corr
from analyze_special_cases import (
    prepare_dataframe,
    analyze_by_build_decade,
    analyze_price_by_location,
    analyze_price_per_sqm,
    find_smallest_most_expensive
)

# –ù–∞—Å—Ç—Ä–æ–π–∫–∏
st.set_page_config(page_title="–ê–Ω–∞–ª–∏–∑ –∞—Ä–µ–Ω–¥—ã –∫–≤–∞—Ä—Ç–∏—Ä", layout="wide")
data_path = Path(__file__).parent.parent / "data" / "processed_offers.csv"

@st.cache_data
def load_data():
    df = pd.read_csv(data_path)
    df = prepare_dataframe(df)
    df = calculate_additional_columns(df)
    return df

df = load_data()

st.sidebar.title("–ú–µ–Ω—é –Ω–∞–≤–∏–≥–∞—Ü–∏–∏")
page = st.sidebar.radio("–ü–µ—Ä–µ–π—Ç–∏ –∫:", [
    "üè† –ì–ª–∞–≤–Ω–∞—è",
    "üìä –î–∞–Ω–Ω—ã–µ",
    "üîç EDA",
    "üìà –¢—Ä–µ–Ω–¥—ã –∏ –∑–∞–∫–æ–Ω–æ–º–µ—Ä–Ω–æ—Å—Ç–∏",
    "üìå –í—ã–≤–æ–¥—ã –∏ —Ä–µ–∫–æ–º–µ–Ω–¥–∞—Ü–∏–∏"
])

# –ü–µ—Ä–µ–æ–ø—Ä–µ–¥–µ–ª—è–µ–º –ø—Ä–æ–±–ª–µ–º–Ω—É—é —Ñ—É–Ω–∫—Ü–∏—é
def analyze_price_per_sqm_patch(df):
    valid = df[df["price_per_sqm"].notna()]
    stats = valid["price_per_sqm"].describe().round(2)
    top5_table = valid.sort_values("price_per_sqm", ascending=False).head(5)[
        ["price", "square_meters", "price_per_sqm", "address", "metro"]
    ].round(2)
    plt.figure(figsize=(10, 4))
    sns.histplot(valid["price_per_sqm"], bins=40, kde=True)
    plt.title("–†–∞—Å–ø—Ä–µ–¥–µ–ª–µ–Ω–∏–µ —Ü–µ–Ω—ã –∑–∞ –∫–≤–∞–¥—Ä–∞—Ç–Ω—ã–π –º–µ—Ç—Ä")
    plt.xlabel("–¶–µ–Ω–∞ –∑–∞ –º¬≤, ‚ÇΩ")
    plt.tight_layout()
    st.pyplot(plt.gcf())
    plt.clf()
    return stats, top5_table

# –ü–æ–¥–º–µ–Ω—è–µ–º –æ—Ä–∏–≥–∏–Ω–∞–ª—å–Ω—É—é —Ñ—É–Ω–∫—Ü–∏—é
import analyze_special_cases
analyze_special_cases.analyze_price_per_sqm = analyze_price_per_sqm_patch

if page == "üè† –ì–ª–∞–≤–Ω–∞—è":
    st.title("–ü—Ä–æ–µ–∫—Ç: –ê–Ω–∞–ª–∏–∑ —Ñ–∞–∫—Ç–æ—Ä–æ–≤, –≤–ª–∏—è—é—â–∏—Ö –Ω–∞ —Ü–µ–Ω—É –ø–æ—Å—É—Ç–æ—á–Ω–æ–π –∞—Ä–µ–Ω–¥—ã –∫–≤–∞—Ä—Ç–∏—Ä –≤ –ú–æ—Å–∫–≤–µ")
    st.markdown("""
    ## –û–ø–∏—Å–∞–Ω–∏–µ:

–¶–µ–ª—å –ø—Ä–æ–µ–∫—Ç–∞ ‚Äî –∏—Å—Å–ª–µ–¥–æ–≤–∞—Ç—å —Ä—ã–Ω–æ–∫ –ø–æ—Å—É—Ç–æ—á–Ω–æ–π –∞—Ä–µ–Ω–¥—ã –∂–∏–ª—å—è –≤ –ú–æ—Å–∫–≤–µ –∏ –≤—ã—è–≤–∏—Ç—å, –∫–∞–∫–∏–µ —Ñ–∞–∫—Ç–æ—Ä—ã –æ–∫–∞–∑—ã–≤–∞—é—Ç –Ω–∞–∏–±–æ–ª—å—à–µ–µ –≤–ª–∏—è–Ω–∏–µ –Ω–∞ —Ü–µ–Ω—É –∞—Ä–µ–Ω–¥—ã.

### –ò—Å—Ç–æ—á–Ω–∏–∫ –¥–∞–Ω–Ω—ã—Ö

–î–∞–Ω–Ω—ã–µ —Å–æ–±–∏—Ä–∞–ª–∏—Å—å —Å –ø–æ–º–æ—â—å—é –∞–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–æ–≥–æ –ø–∞—Ä—Å–∏–Ω–≥–∞ —Å –ø–æ–ø—É–ª—è—Ä–Ω–æ–π –æ–Ω–ª–∞–π–Ω-–ø–ª–æ—â–∞–¥–∫–∏:
- [realty.yandex.ru](https://realty.yandex.ru/moskva/snyat/kvartira/posutochno/)

–î–ª—è –ø–∞—Ä—Å–∏–Ω–≥–∞ –∏—Å–ø–æ–ª—å–∑–æ–≤–∞–ª–∏—Å—å `selenium` –∏ `webdriver-manager`.

### –ß—Ç–æ –∞–Ω–∞–ª–∏–∑–∏—Ä—É–µ—Ç—Å—è

–í —Ö–æ–¥–µ –∞–Ω–∞–ª–∏–∑–∞ –∏—Å—Å–ª–µ–¥—É—é—Ç—Å—è —Å–ª–µ–¥—É—é—â–∏–µ –≥—Ä—É–ø–ø—ã –ø—Ä–∏–∑–Ω–∞–∫–æ–≤:

- **–õ–æ–∫–∞—Ü–∏—è**: —Å—Ç–∞–Ω—Ü–∏—è –º–µ—Ç—Ä–æ, –∞–¥—Ä–µ—Å, —Ä–∞–π–æ–Ω;
- **–§–∏–∑–∏—á–µ—Å–∫–∏–µ –ø–∞—Ä–∞–º–µ—Ç—Ä—ã**: –ø–ª–æ—â–∞–¥—å, —ç—Ç–∞–∂, —ç—Ç–∞–∂–Ω–æ—Å—Ç—å, –≥–æ–¥ –ø–æ—Å—Ç—Ä–æ–π–∫–∏, –≤—ã—Å–æ—Ç–∞ –ø–æ—Ç–æ–ª–∫–æ–≤;
- **–°–æ—Å—Ç–∞–≤–Ω—ã–µ —Ö–∞—Ä–∞–∫—Ç–µ—Ä–∏—Å—Ç–∏–∫–∏**: —Ç–∏–ø —Å–∞–Ω—É–∑–ª–∞, –æ—Ç–¥–µ–ª–∫–∞, —É–¥–æ–±—Å—Ç–≤–∞, –Ω–∞–ª–∏—á–∏–µ –ø—Ä–µ–¥–æ–ø–ª–∞—Ç—ã –∏ —Ç.–¥.;
- **–ü–æ–∫–∞–∑–∞—Ç–µ–ª–∏ —ç—Ñ—Ñ–µ–∫—Ç–∏–≤–Ω–æ—Å—Ç–∏**: —Ü–µ–Ω–∞ –∑–∞ –∫–≤–∞–¥—Ä–∞—Ç–Ω—ã–π –º–µ—Ç—Ä.

–ê–Ω–∞–ª–∏–∑ –≤–∫–ª—é—á–∞–µ—Ç:
- –æ—á–∏—Å—Ç–∫—É –∏ –Ω–æ—Ä–º–∞–ª–∏–∑–∞—Ü–∏—é –¥–∞–Ω–Ω—ã—Ö;
- –∏–∑–≤–ª–µ—á–µ–Ω–∏–µ –ø—Ä–∏–∑–Ω–∞–∫–æ–≤ –∏–∑ –ø–æ–ª—É—Å—Ç—Ä—É–∫—Ç—É—Ä–∏—Ä–æ–≤–∞–Ω–Ω—ã—Ö –±–ª–æ–∫–æ–≤ (—Å–ø–∏—Å–∫–∏ —Ö–∞—Ä–∞–∫—Ç–µ—Ä–∏—Å—Ç–∏–∫);
- —Ä–∞—Å—á–µ—Ç –ø—Ä–æ–∏–∑–≤–æ–¥–Ω—ã—Ö –ø—Ä–∏–∑–Ω–∞–∫–æ–≤;
- –≤–∏–∑—É–∞–ª–∏–∑–∞—Ü–∏—é —Ä–∞—Å–ø—Ä–µ–¥–µ–ª–µ–Ω–∏–π –∏ –∑–∞–≤–∏—Å–∏–º–æ—Å—Ç–µ–π;
- –ø–æ–∏—Å–∫ –≤—ã–±—Ä–æ—Å–æ–≤ –∏ –Ω–µ—Ç–∏–ø–∏—á–Ω—ã—Ö –æ–±—ä–µ–∫—Ç–æ–≤.

–ü—Ä–æ–µ–∫—Ç –∑–∞–≤–µ—Ä—à—ë–Ω –∏–Ω—Ç–µ—Ä–ø—Ä–µ—Ç–∞—Ü–∏–µ–π –∫–ª—é—á–µ–≤—ã—Ö –∑–∞–∫–æ–Ω–æ–º–µ—Ä–Ω–æ—Å—Ç–µ–π –∏ –º–æ–∂–µ—Ç –±—ã—Ç—å –∏—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω –∫–∞–∫ –æ—Å–Ω–æ–≤–∞ –¥–ª—è —Ü–µ–Ω–æ–æ–±—Ä–∞–∑–æ–≤–∞–Ω–∏—è, —Ä–µ–∫–æ–º–µ–Ω–¥–∞—Ç–µ–ª—å–Ω—ã—Ö —Å–∏—Å—Ç–µ–º –∏ –º–æ–¥–µ–ª–∏—Ä–æ–≤–∞–Ω–∏—è –∞—Ä–µ–Ω–¥–Ω–æ–≥–æ —Å–ø—Ä–æ—Å–∞.
    """)

elif page == "üìä –î–∞–Ω–Ω—ã–µ":
    st.title("–û–±–∑–æ—Ä –¥–∞–Ω–Ω—ã—Ö")
    st.markdown("–ò–Ω—Ç–µ—Ä–∞–∫—Ç–∏–≤–Ω–∞—è —Ç–∞–±–ª–∏—Ü–∞ —Å –≤–æ–∑–º–æ–∂–Ω–æ—Å—Ç—å—é —Å–æ—Ä—Ç–∏—Ä–æ–≤–∫–∏ –∏ –ø—Ä–æ—Å–º–æ—Ç—Ä–∞.")
    st.dataframe(df.dropna(how='all', axis=1))  # drop problematic columns

    st.subheader("–û–±—â–∏–µ –ø–æ–∫–∞–∑–∞—Ç–µ–ª–∏")
    col1, col2, col3 = st.columns(3)
    col1.metric("–í—Å–µ–≥–æ –∑–∞–ø–∏—Å–µ–π", len(df))
    col2.metric("–ü—Ä–æ–ø—É—Å–∫–æ–≤ –≤—Å–µ–≥–æ", df.isna().sum().sum())
    col3.metric("–£–Ω–∏–∫–∞–ª—å–Ω—ã—Ö –∞–¥—Ä–µ—Å–æ–≤", df['address'].nunique())

elif page == "üîç EDA":
    st.title("–ò—Å—Å–ª–µ–¥–æ–≤–∞—Ç–µ–ª—å—Å–∫–∏–π –∞–Ω–∞–ª–∏–∑ –¥–∞–Ω–Ω—ã—Ö")
    st.markdown("""
        **–ß—Ç–æ —Å–¥–µ–ª–∞–Ω–æ:**

- –û–ø—Ä–µ–¥–µ–ª–µ–Ω—ã:
  - —Å–ø–∏—Å–æ–∫ –∫–æ–ª–æ–Ω–æ–∫
  - —Ç–∏–ø—ã –¥–∞–Ω–Ω—ã—Ö (`float64`, `object`, –∏ —Ç.–¥.)
  - –∫–æ–ª–∏—á–µ—Å—Ç–≤–æ –ø—Ä–æ–ø—É—Å–∫–æ–≤
  - –∫–æ–ª–∏—á–µ—Å—Ç–≤–æ —É–Ω–∏–∫–∞–ª—å–Ω—ã—Ö –∑–Ω–∞—á–µ–Ω–∏–π
  - –ø—Ä–∏–º–µ—Ä—ã –∑–Ω–∞—á–µ–Ω–∏–π (–¥–æ 5 –Ω–∞ –∫–æ–ª–æ–Ω–∫—É)

---

## –í—ã–≤–æ–¥—ã –ø–æ –¥–∞–Ω–Ω—ã–º
- –û—Å–Ω–æ–≤–Ω—ã–µ –ø—Ä–æ–ø—É—Å–∫–∏ —Å–≤—è–∑–∞–Ω—ã —Å –ø–ª–æ—â–∞–¥—è–º–∏ (–∂–∏–ª–∞—è, –∫—É—Ö–Ω—è) –∏ –¥–æ–ø–æ–ª–Ω–∏—Ç–µ–ª—å–Ω–æ–π –∏–Ω—Ñ–æ—Ä–º–∞—Ü–∏–µ–π –æ –¥–æ–º–µ (–ø–æ–¥—ä–µ–∑–¥—ã, –∫–≤–∞—Ä—Ç–∏—Ä—ã).
- –ü–æ–ª—è `price`, `square_meters`, `floor`, `build_year` ‚Äî –ø–æ—á—Ç–∏ –ø–æ–ª–Ω—ã–µ, –ø–æ–¥—Ö–æ–¥—è—Ç –¥–ª—è –∞–Ω–∞–ª–∏–∑–∞ –∏ –≤–∏–∑—É–∞–ª–∏–∑–∞—Ü–∏–π.
- –ü—Ä–æ–ø—É—Å–∫–∏ –≤ `renovation_type` –∏ `bathroom_type` –æ—Ç—Ä–∞–∂–∞—é—Ç –æ—Ç—Å—É—Ç—Å—Ç–≤–∏–µ —ç—Ç–∏—Ö –¥–∞–Ω–Ω—ã—Ö –≤ –∫–∞—Ä—Ç–æ—á–∫–∞—Ö ‚Äî —ç—Ç–æ –∏–Ω—Ñ–æ—Ä–º–∞—Ç–∏–≤–Ω–æ.

- –í—Å–µ –∏–∑–≤–ª–µ–∫–∞–µ–º—ã–µ –∑–Ω–∞—á–µ–Ω–∏—è (–≤–∫–ª—é—á–∞—è `technical_info`, `building_info`, `amenities`, `tags`) –ø—Ä–µ–¥—Å—Ç–∞–≤–ª–µ–Ω—ã **—Å—Ç—Ä—É–∫—Ç—É—Ä–∏—Ä–æ–≤–∞–Ω–Ω—ã–º–∏ —à–∞–±–ª–æ–Ω–∞–º–∏** –∏–ª–∏ **–æ–≥—Ä–∞–Ω–∏—á–µ–Ω–Ω—ã–º —á–∏—Å–ª–æ–º –∫–∞—Ç–µ–≥–æ—Ä–∏–π**.
- –ú—ã **–Ω–µ –∞–Ω–∞–ª–∏–∑–∏—Ä—É–µ–º –ø—Ä–æ–∏–∑–≤–æ–ª—å–Ω—ã–π —Ç–µ–∫—Å—Ç** (–∫–∞–∫, –Ω–∞–ø—Ä–∏–º–µ—Ä, –æ—Ç–∑—ã–≤—ã, –æ–ø–∏—Å–∞–Ω–∏—è –∏–ª–∏ –∫–æ–º–º–µ–Ω—Ç–∞—Ä–∏–∏).
- –û–±—Ä–∞–±–æ—Ç–∫–∞ —Å–≤–æ–¥–∏—Ç—Å—è –∫ —Ä–∞—Å–ø–æ–∑–Ω–∞–≤–∞–Ω–∏—é —Ä–µ–≥—É–ª—è—Ä–Ω—ã—Ö –≤—ã—Ä–∞–∂–µ–Ω–∏–π, –∞ –Ω–µ —Å–µ–º–∞–Ω—Ç–∏—á–µ—Å–∫–æ–º—É –∞–Ω–∞–ª–∏–∑—É.
- –ü—Ä–∏–º–µ—Ä—ã:
  - `–û—Ç–¥–µ–ª–∫–∞ ‚Äî –∫–æ—Å–º–µ—Ç–∏—á–µ—Å–∫–∏–π —Ä–µ–º–æ–Ω—Ç` ‚Üí —Ç–∏–ø –æ—Ç–¥–µ–ª–∫–∏
  - `–°–∞–Ω—É–∑–µ–ª —Å–æ–≤–º–µ—â—ë–Ω–Ω—ã–π` ‚Üí —Ç–∏–ø —Å–∞–Ω—É–∑–ª–∞
  - `9 —ç—Ç–∞–∂–µ–π`, `60 –∫–≤–∞—Ä—Ç–∏—Ä`, `–î–æ–º 1981 –≥.` ‚Üí —è–≤–Ω–æ —Å—Ç—Ä—É–∫—Ç—É—Ä–∏—Ä–æ–≤–∞–Ω–Ω—ã–µ —Ñ–æ—Ä–º–∞—Ç—ã

–¢–∞–∫–∏–º –æ–±—Ä–∞–∑–æ–º, **–Ω–∏ –º–æ—Ä—Ñ–æ–ª–æ–≥–∏—á–µ—Å–∫–∞—è –Ω–æ—Ä–º–∞–ª–∏–∑–∞—Ü–∏—è, –Ω–∏ —Ç–æ–∫–µ–Ω–∏–∑–∞—Ü–∏—è –Ω–µ —Ç—Ä–µ–±—É—é—Ç—Å—è**, –ø–æ—Å–∫–æ–ª—å–∫—É –æ–±—Ä–∞–±–æ—Ç–∫–∞ –æ–ø–∏—Ä–∞–µ—Ç—Å—è –Ω–∞ —Ñ–∏–∫—Å–∏—Ä–æ–≤–∞–Ω–Ω—ã–µ —Å–ª–æ–≤–µ—Å–Ω—ã–µ —à–∞–±–ª–æ–Ω—ã, –∞ –Ω–µ –Ω–∞ —Å–≤–æ–±–æ–¥–Ω—ã–π —Ç–µ–∫—Å—Ç.

---

–î–∞–Ω–Ω—ã–µ —É—Å–ø–µ—à–Ω–æ –ø–æ–¥–≥–æ—Ç–æ–≤–ª–µ–Ω—ã –∫ –¥–∞–ª—å–Ω–µ–π—à–µ–º—É –∞–Ω–∞–ª–∏–∑—É: –≤–∏–∑—É–∞–ª–∏–∑–∞—Ü–∏—è–º, –ø–æ–∏—Å–∫—É –∑–∞–∫–æ–Ω–æ–º–µ—Ä–Ω–æ—Å—Ç–µ–π, –ø–æ—Å—Ç—Ä–æ–µ–Ω–∏—é –º–æ–¥–µ–ª–µ–π –∏ —Ñ–æ—Ä–º—É–ª–∏—Ä–æ–≤–∫–µ –≤—ã–≤–æ–¥–æ–≤.
        """)
    numeric_cols = df.select_dtypes(include="number").columns.tolist()
    selected_col = st.selectbox("–í—ã–±–µ—Ä–∏—Ç–µ —á–∏—Å–ª–æ–≤–æ–π –ø—Ä–∏–∑–Ω–∞–∫", numeric_cols)

    if selected_col:
        plot_distribution(df, selected_col, selected_col)
        st.pyplot(plt.gcf())
        plt.clf()

    st.subheader("–û–±–∑–æ—Ä–Ω–∞—è —Å–≤–æ–¥–∫–∞ –ø—Ä–∏–∑–Ω–∞–∫–æ–≤")
    eda_result = run_eda(str(data_path))
    st.dataframe(eda_result)

elif page == "üìà –¢—Ä–µ–Ω–¥—ã –∏ –∑–∞–∫–æ–Ω–æ–º–µ—Ä–Ω–æ—Å—Ç–∏":
    st.title("–ê–Ω–∞–ª–∏–∑ –∑–∞–∫–æ–Ω–æ–º–µ—Ä–Ω–æ—Å—Ç–µ–π")
    st.markdown("""
    #### 1. –ê–Ω–∞–ª–∏–∑ –ø–æ —ç–ø–æ—Ö–∞–º –ø–æ—Å—Ç—Ä–æ–π–∫–∏ (`build_year`)

##### –¶–µ–ª—å
–ü–æ–Ω—è—Ç—å, –∫–∞–∫ –∏–∑–º–µ–Ω—è–µ—Ç—Å—è —Å—Ç–æ–∏–º–æ—Å—Ç—å –∞—Ä–µ–Ω–¥—ã –≤ –∑–∞–≤–∏—Å–∏–º–æ—Å—Ç–∏ –æ—Ç –ø–µ—Ä–∏–æ–¥–∞ –ø–æ—Å—Ç—Ä–æ–π–∫–∏ –∑–¥–∞–Ω–∏—è. –ü—Ä–µ–¥–ø–æ–ª–æ–∂–µ–Ω–∏–µ: –Ω–∞–∏–±–æ–ª–µ–µ –≤—ã—Å–æ–∫–∞—è
—Ü–µ–Ω–∞ –±—É–¥–µ—Ç —É —Å–∞–º—ã—Ö –Ω–æ–≤—ã—Ö –∏ —Å–∞–º—ã—Ö —Å—Ç–∞—Ä—ã—Ö –¥–æ–º–æ–≤.

##### –†–µ–∞–ª–∏–∑–∞—Ü–∏—è
- –ì–æ–¥ –ø–æ—Å—Ç—Ä–æ–π–∫–∏ (`build_year`) —Ä–∞–∑–±–∏—Ç –Ω–∞ –≥—Ä—É–ø–ø—ã:
  - `–¥–æ 1960`
  - `1960‚Äì1969`, `1970‚Äì1979`, ‚Ä¶ `2020‚Äì2029`
- –î–ª—è –∫–∞–∂–¥–æ–π –≥—Ä—É–ø–ø—ã —Ä–∞—Å—Å—á–∏—Ç–∞–Ω–∞ —Å—Ä–µ–¥–Ω—è—è —Ü–µ–Ω–∞ –∞—Ä–µ–Ω–¥—ã.
- –ü–æ—Å—Ç—Ä–æ–µ–Ω barplot.

##### –ò–Ω—Ç–µ—Ä–ø—Ä–µ—Ç–∞—Ü–∏—è
- –°–∞–º–∞—è –≤—ã—Å–æ–∫–∞—è —Å—Ä–µ–¥–Ω—è—è —Ü–µ–Ω–∞ —É –∫–∞—Ç–µ–≥–æ—Ä–∏–∏ **¬´–¥–æ 1960¬ª** ‚Äî –≤–æ–∑–º–æ–∂–Ω—ã –∏—Å—Ç–æ—Ä–∏—á–µ—Å–∫–∏–µ –∑–¥–∞–Ω–∏—è –≤ —Ü–µ–Ω—Ç—Ä–µ.
- –ù–æ–≤—ã–µ –¥–æ–º–∞ 2000-—Ö —Ç–æ–∂–µ –≤—ã—à–µ —Å—Ä–µ–¥–Ω–µ–≥–æ.
- –î–æ–º–∞ 1980-—Ö ‚Äî —Å–∞–º—ã–µ ¬´—ç–∫–æ–Ω–æ–º–∏—á–Ω—ã–µ¬ª –ø–æ –∞—Ä–µ–Ω–¥–µ.

---

#### 2. –ê–Ω–∞–ª–∏–∑ –ø–æ `metro` –∏ `address`

##### –¶–µ–ª—å
–í—ã—è–≤–∏—Ç—å –ª–æ–∫–∞–ª—å–Ω—ã–µ —Ä–∞–∑–ª–∏—á–∏—è –≤ —Ü–µ–Ω–∞—Ö: –≥–¥–µ –∞—Ä–µ–Ω–¥–∞ —Å–∞–º–∞—è –¥–æ—Ä–æ–≥–∞—è ‚Äî –ø–æ —Å—Ç–∞–Ω—Ü–∏—è–º –º–µ—Ç—Ä–æ –∏ –ø–æ —É–ª–∏—Ü–∞–º.

##### –†–µ–∞–ª–∏–∑–∞—Ü–∏—è
- –†–∞—Å—Å—á–∏—Ç–∞–Ω–∞ —Å—Ä–µ–¥–Ω—è—è —Ü–µ–Ω–∞ –∞—Ä–µ–Ω–¥—ã –ø–æ –∫–∞–∂–¥–æ–º—É `metro` –∏ `address`.
- –û—Ç–æ–±—Ä–∞–Ω—ã —Ç–æ–ø-20 –ø–æ —Ü–µ–Ω–µ.
- –í–∏–∑—É–∞–ª–∏–∑–∏—Ä–æ–≤–∞–Ω—ã barplot'—ã –∏ —Ç–∞–±–ª–∏—Ü—ã —Å –≥—Ä–∞–¥–∏–µ–Ω—Ç–Ω–æ–π –∑–∞–ª–∏–≤–∫–æ–π.

##### –ò–Ω—Ç–µ—Ä–ø—Ä–µ—Ç–∞—Ü–∏—è
- –°–∞–º—ã–µ –¥–æ—Ä–æ–≥–∏–µ —Å—Ç–∞–Ω—Ü–∏–∏ –º–µ—Ç—Ä–æ ‚Äî **–î–µ–ª–æ–≤–æ–π —Ü–µ–Ω—Ç—Ä**, **–ü—É—à–∫–∏–Ω—Å–∫–∞—è**, **–¢–∞–≥–∞–Ω—Å–∫–∞—è**.
- –¢–æ–ø-–∞–¥—Ä–µ—Å–∞ —Å–æ—Å—Ä–µ–¥–æ—Ç–æ—á–µ–Ω—ã –≤ **–¶–ê–û**: **–ê—Ä–±–∞—Ç**, **–¢–≤–µ—Ä—Å–∫–∞—è**, **–ö–æ—Ç–µ–ª—å–Ω–∏—á–µ—Å–∫–∞—è –Ω–∞–±–µ—Ä–µ–∂–Ω–∞—è**.
- –û—Ç–ª–∏—á–Ω–æ –ø—Ä–æ—è–≤–ª—è–µ—Ç—Å—è —ç—Ñ—Ñ–µ–∫—Ç ¬´–ø—Ä–µ—Å—Ç–∏–∂–Ω–æ—Å—Ç–∏¬ª –∏ **–±–ª–∏–∑–æ—Å—Ç–∏ –∫ –¥–µ–ª–æ–≤–æ–º—É —Ü–µ–Ω—Ç—Ä—É**.

_–§–∞–∫—Ç–æ—Ä –≥–µ–æ–ª–æ–∫–∞—Ü–∏–∏ ‚Äî –æ–¥–∏–Ω –∏–∑ –∫–ª—é—á–µ–≤—ã—Ö –¥—Ä–∞–π–≤–µ—Ä–æ–≤ —Ü–µ–Ω—ã. –ù–µ –∫–≤–∞–¥—Ä–∞—Ç–Ω—ã–µ –º–µ—Ç—Ä—ã, –∞ –∫–æ–æ—Ä–¥–∏–Ω–∞—Ç—ã._

---

#### 3. –ê–Ω–∞–ª–∏–∑ —Ü–µ–Ω—ã –∑–∞ –∫–≤–∞–¥—Ä–∞—Ç–Ω—ã–π –º–µ—Ç—Ä (`price_per_sqm`)

##### –¶–µ–ª—å
–í—ã—è–≤–∏—Ç—å –≤–ª–∏—è–Ω–∏–µ –ø–ª–æ—â–∞–¥–∏ –Ω–∞ —Ü–µ–Ω—É –∏ –≤—ã—è–≤–∏—Ç—å –æ–±—ä–µ–∫—Ç—ã —Å –∑–∞–≤—ã—à–µ–Ω–Ω–æ–π –∏–ª–∏ –∑–∞–Ω–∏–∂–µ–Ω–Ω–æ–π —Å—Ç–æ–∏–º–æ—Å—Ç—å—é –∞—Ä–µ–Ω–¥—ã –Ω–∞ –µ–¥–∏–Ω–∏—Ü—É –ø–ª–æ—â–∞–¥–∏.

##### –†–µ–∞–ª–∏–∑–∞—Ü–∏—è
- –î–æ–±–∞–≤–ª–µ–Ω –ø—Ä–∏–∑–Ω–∞–∫: `price_per_sqm = price / square_meters`
- –ü–æ—Å—Ç—Ä–æ–µ–Ω–æ —Ä–∞—Å–ø—Ä–µ–¥–µ–ª–µ–Ω–∏–µ –∑–Ω–∞—á–µ–Ω–∏–π.
- –í—ã–≤–µ–¥–µ–Ω—ã –∫–ª—é—á–µ–≤—ã–µ —Å—Ç–∞—Ç–∏—Å—Ç–∏–∫–∏ (`min`, `max`, `–º–µ–¥–∏–∞–Ω–∞` –∏ –ø—Ä.)
- –û—Ç–æ–±—Ä–∞–Ω—ã —Ç–æ–ø-5 –∫–≤–∞—Ä—Ç–∏—Ä —Å –Ω–∞–∏–±–æ–ª—å—à–µ–π —Ü–µ–Ω–æ–π –∑–∞ –º¬≤.

##### –ò–Ω—Ç–µ—Ä–ø—Ä–µ—Ç–∞—Ü–∏—è
- –ú–µ–¥–∏–∞–Ω–Ω–∞—è —Å—Ç–æ–∏–º–æ—Å—Ç—å –∞—Ä–µ–Ω–¥—ã –∑–∞ –º¬≤ ‚Äî **93.6 ‚ÇΩ**, —Å—Ä–µ–¥–Ω—è—è ‚Äî **108 ‚ÇΩ**.
- –í —Ä–∞—Å–ø—Ä–µ–¥–µ–ª–µ–Ω–∏–∏ –Ω–∞–±–ª—é–¥–∞–µ—Ç—Å—è –ø—Ä–∞–≤–æ—Å—Ç–æ—Ä–æ–Ω–Ω—è—è –∞—Å–∏–º–º–µ—Ç—Ä–∏—è.
- –ö–≤–∞—Ä—Ç–∏—Ä—ã —Å —Ü–µ–Ω–æ–π –∑–∞ –º¬≤ –≤—ã—à–µ **300 ‚ÇΩ** ‚Äî —Å–∫–æ—Ä–µ–µ –∏—Å–∫–ª—é—á–µ–Ω–∏–µ, —á–µ–º –ø—Ä–∞–≤–∏–ª–æ.

_–¶–µ–Ω–∞ –∑–∞ –º¬≤ –¥–∞—ë—Ç –±–æ–ª–µ–µ –æ–±—ä–µ–∫—Ç–∏–≤–Ω–æ–µ —Å—Ä–∞–≤–Ω–µ–Ω–∏–µ –∫–≤–∞—Ä—Ç–∏—Ä. –û—Å–æ–±–µ–Ω–Ω–æ –ø–æ–ª–µ–∑–Ω–æ –ø—Ä–∏ –∞–Ω–∞–ª–∏–∑–µ —Å—Ç—É–¥–∏–π, –æ–¥–Ω—É—à–µ–∫ –∏ —ç–ª–∏—Ç–Ω—ã—Ö –æ–±—ä–µ–∫—Ç–æ–≤._

---

#### 4. –°–∞–º–∞—è –¥–æ—Ä–æ–≥–∞—è (–∑–∞ –º¬≤) –∏ –ø—Ä–∏ —ç—Ç–æ–º –º–∞–ª–µ–Ω—å–∫–∞—è –∫–≤–∞—Ä—Ç–∏—Ä–∞

##### –¶–µ–ª—å
–ò—Ä–æ–Ω–∏—á–Ω—ã–π –ø–æ–∏—Å–∫ –æ–±—ä–µ–∫—Ç–∞, –∫–æ—Ç–æ—Ä—ã–π –æ–¥–Ω–æ–≤—Ä–µ–º–µ–Ω–Ω–æ:
- –æ—á–µ–Ω—å –º–∞–ª–µ–Ω—å–∫–∏–π –ø–æ –ø–ª–æ—â–∞–¥–∏,
- –æ—á–µ–Ω—å –¥–æ—Ä–æ–≥–æ–π –∑–∞ –º¬≤.

##### –†–µ–∞–ª–∏–∑–∞—Ü–∏—è
- –û—Ç–æ–±—Ä–∞–Ω–∞ –∫–≤–∞—Ä—Ç–∏—Ä–∞ —Å –º–∞–∫—Å–∏–º–∞–ª—å–Ω–æ–π `price_per_sqm` –ø—Ä–∏ –º–∏–Ω–∏–º–∞–ª—å–Ω–æ–π `square_meters`.

##### –†–µ–∑—É–ª—å—Ç–∞—Ç
- **–ü–ª–æ—â–∞–¥—å**: 15.0 –º¬≤
- **–¶–µ–Ω–∞**: 6990 ‚ÇΩ
- **–¶–µ–Ω–∞ –∑–∞ –º¬≤**: **466.00 ‚ÇΩ/–º¬≤**
- **–ê–¥—Ä–µ—Å**: 1-–π –ö—Ä–∞—Å–Ω–æ–≥–≤–∞—Ä–¥–µ–π—Å–∫–∏–π –ø—Ä–æ–µ–∑–¥
- **–ú–µ—Ç—Ä–æ**: –î–µ–ª–æ–≤–æ–π —Ü–µ–Ω—Ç—Ä

_–û–±—ä–µ–∫—Ç —è–≤–Ω–æ –Ω–µ —Ä–∞—Å—Å—á–∏—Ç–∞–Ω –Ω–∞ –¥–æ–ª–≥–æ–≤—Ä–µ–º–µ–Ω–Ω–æ–µ –ø—Ä–æ–∂–∏–≤–∞–Ω–∏–µ. –°–∫–æ—Ä–µ–µ —ç—Ç–æ —Ç–æ—á–∫–∞ —Ä–æ—Å—Ç–∞ –¥–ª—è –∏–Ω–≤–µ—Å—Ç–æ—Ä–∞ —Å —Ö–æ—Ä–æ—à–µ–π —Ñ–∞–Ω—Ç–∞–∑–∏–µ–π –∏ —Å–ª–∞–±—ã–º —á—É–≤—Å—Ç–≤–æ–º –∏—Ä–æ–Ω–∏–∏._

---

#### –û–±—â–∏–µ –≤—ã–≤–æ–¥—ã

- –ê—Ä–µ–Ω–¥–∞ –≤ –ú–æ—Å–∫–≤–µ ‚Äî —ç—Ç–æ —Å–ª–æ–∂–Ω—ã–π –∫–æ–Ω—Å—Ç—Ä—É–∫—Ç –∏–∑ –ø—Ä–∏–∑–Ω–∞–∫–æ–≤: –ø–ª–æ—â–∞–¥—å, –≥–æ–¥, —Å—Ç–∞–Ω—Ü–∏—è –º–µ—Ç—Ä–æ, –∞–¥—Ä–µ—Å, —ç—Ç–∞–∂ –∏ –¥–∞–∂–µ –∫—É—Ö–æ–Ω–Ω—ã–π –∫–æ—ç—Ñ—Ñ–∏—Ü–∏–µ–Ω—Ç.
- –ì–µ–æ–≥—Ä–∞—Ñ–∏—è –∏ —Ç–∏–ø –∑–¥–∞–Ω–∏—è —á–∞—Å—Ç–æ –¥–æ–º–∏–Ω–∏—Ä—É—é—Ç –Ω–∞–¥ —Ñ–∏–∑–∏—á–µ—Å–∫–∏–º–∏ —Ö–∞—Ä–∞–∫—Ç–µ—Ä–∏—Å—Ç–∏–∫–∞–º–∏.
- –ê–Ω–∞–ª–∏–∑ –∑–∞ –º¬≤ ‚Äî –º–æ—â–Ω—ã–π –∏–Ω—Å—Ç—Ä—É–º–µ–Ω—Ç –¥–ª—è –≤—ã—è–≤–ª–µ–Ω–∏—è –Ω–µ–æ—á–µ–≤–∏–¥–Ω—ã—Ö –ø–µ—Ä–µ–æ—Ü–µ–Ω—ë–Ω–Ω—ã—Ö –∫–≤–∞—Ä—Ç–∏—Ä.

_–°—É—Ö–∏–µ –º–µ—Ç—Ä—ã –±–µ–∑ –∫–æ–Ω—Ç–µ–∫—Å—Ç–∞ –Ω–µ –æ–±—ä—è—Å–Ω—è—é—Ç —Ü–µ–Ω—É. –ê –≤–æ—Ç —Å–æ—á–µ—Ç–∞–Ω–∏–µ –ø—Ä–∏–∑–Ω–∞–∫–æ–≤ ‚Äî —É–∂–µ –≤–ø–æ–ª–Ω–µ._
            """)
    option = st.selectbox("–í—ã–±–µ—Ä–∏—Ç–µ —Ç–∏–ø –∞–Ω–∞–ª–∏–∑–∞", [
        "–ö–æ—Ä—Ä–µ–ª—è—Ü–∏–∏ —Å —Ü–µ–Ω–æ–π",
        "–¶–µ–Ω–∞ –ø–æ —ç–ø–æ—Ö–∞–º –ø–æ—Å—Ç—Ä–æ–π–∫–∏",
        "–°—Ä–µ–¥–Ω—è—è —Ü–µ–Ω–∞ –ø–æ –º–µ—Ç—Ä–æ",
        "–¢–û–ü-–∞–¥—Ä–µ—Å–∞ –ø–æ —Ü–µ–Ω–µ",
        "–¶–µ–Ω–∞ –∑–∞ –º¬≤",
        "–°–∞–º–∞—è –¥–æ—Ä–æ–≥–∞—è –∫–≤–∞—Ä—Ç–∏—Ä–∞ –∑–∞ –º¬≤"
    ])

    if option == "–ö–æ—Ä—Ä–µ–ª—è—Ü–∏–∏ —Å —Ü–µ–Ω–æ–π":
        st.subheader("–ö–æ—Ä—Ä–µ–ª—è—Ü–∏–∏")
        numeric = ["square_meters", "living_meters", "kitchen_meters", "ceiling_height",
                   "floor", "build_year", "building_floors", "apartments_count", "entrances_count",
                   "living_ratio", "kitchen_ratio", "floors_diff", "density"]
        analyze_numeric_corr(df, numeric)
        st.pyplot(plt.gcf())
        plt.clf()

    elif option == "–¶–µ–Ω–∞ –ø–æ —ç–ø–æ—Ö–∞–º –ø–æ—Å—Ç—Ä–æ–π–∫–∏":
        st.subheader("–°—Ä–µ–¥–Ω—è—è —Ü–µ–Ω–∞ –ø–æ —ç–ø–æ—Ö–∞–º")
        summary = analyze_by_build_decade(df)
        st.dataframe(summary)
        st.pyplot(plt.gcf())
        plt.clf()

    elif option == "–°—Ä–µ–¥–Ω—è—è —Ü–µ–Ω–∞ –ø–æ –º–µ—Ç—Ä–æ":
        st.subheader("–¢–û–ü —Å—Ç–∞–Ω—Ü–∏–π –º–µ—Ç—Ä–æ")
        metro_table, _ = analyze_price_by_location(df)
        st.dataframe(metro_table)
        st.pyplot(plt.gcf())
        plt.clf()

    elif option == "–¢–û–ü-–∞–¥—Ä–µ—Å–∞ –ø–æ —Ü–µ–Ω–µ":
        st.subheader("–¢–û–ü –∞–¥—Ä–µ—Å–æ–≤")
        _, address_table = analyze_price_by_location(df)
        st.dataframe(address_table)
        st.pyplot(plt.gcf())
        plt.clf()

    elif option == "–¶–µ–Ω–∞ –∑–∞ –º¬≤":
        st.subheader("–¶–µ–Ω–∞ –∑–∞ –∫–≤–∞–¥—Ä–∞—Ç–Ω—ã–π –º–µ—Ç—Ä")
        stats, top5_table = analyze_price_per_sqm(df)
        st.write(stats)
        st.dataframe(top5_table)

    elif option == "–°–∞–º–∞—è –¥–æ—Ä–æ–≥–∞—è –∫–≤–∞—Ä—Ç–∏—Ä–∞ –∑–∞ –º¬≤":
        st.subheader("–ù–∞–∏–±–æ–ª–µ–µ –¥–æ—Ä–æ–≥–æ–π –æ–±—ä–µ–∫—Ç –ø–æ –º¬≤")
        row = find_smallest_most_expensive(df)
        st.write(row)

elif page == "üìå –í—ã–≤–æ–¥—ã –∏ —Ä–µ–∫–æ–º–µ–Ω–¥–∞—Ü–∏–∏":
    st.title("–í—ã–≤–æ–¥—ã –∏ —Ä–µ–∫–æ–º–µ–Ω–¥–∞—Ü–∏–∏")
    st.markdown("""
    # –í—ã–≤–æ–¥—ã
    
1. **–ì–µ–æ–≥—Ä–∞—Ñ–∏—á–µ—Å–∫–∏–π –¥—Ä–∞–π–≤–µ—Ä —Ü–µ–Ω—ã**
    - –õ–æ–∫–∞—Ü–∏—è (—Å—Ç–∞–Ω—Ü–∏—è –º–µ—Ç—Ä–æ, –∞–¥—Ä–µ—Å) –¥–∞—ë—Ç —Å–∞–º—ã–π —Å–∏–ª—å–Ω—ã–π —ç—Ñ—Ñ–µ–∫—Ç –Ω–∞ —Å—Ç–æ–∏–º–æ—Å—Ç—å –∞—Ä–µ–Ω–¥—ã:
         - –¢–æ–ø-—Å—Ç–∞–Ω—Ü–∏–∏: –î–µ–ª–æ–≤–æ–π —Ü–µ–Ω—Ç—Ä, –ü—É—à–∫–∏–Ω—Å–∫–∞—è, –¢–∞–≥–∞–Ω—Å–∫–∞—è.
         - –¢–æ–ø-—É–ª–∏—Ü—ã: –°–ª–∞–≤—è–Ω—Å–∫–∞—è –ø–ª–æ—â–∞–¥—å, —É–ª–∏—Ü–∞ –ê—Ä—Ö–∏—Ç–µ–∫—Ç–æ—Ä–∞ –©—É—Å–µ–≤–∞, –ü—Ä–µ—Å–Ω–µ–Ω—Å–∫–∞—è –Ω–∞–±–µ—Ä–µ–∂–Ω–∞—è.

2. **–í–æ–∑—Ä–∞—Å—Ç –¥–æ–º–∞ ‚Äî –ø—Ä–∏–∑–Ω–∞–∫ –ø—Ä–µ–º–∏–∞–ª—å–Ω–æ—Å—Ç–∏**
   - –î–æ–º–∞ –¥–æ 1960 –≥. –∏ –ø–æ—Å—Ç—Ä–æ–π–∫–∏ 2000‚Äì2009 –≥–≥. –¥–µ–º–æ–Ω—Å—Ç—Ä–∏—Ä—É—é—Ç —Å–∞–º—ã–µ –≤—ã—Å–æ–∫–∏–µ —Å—Ä–µ–¥–Ω–∏–µ —Ü–µ–Ω—ã.
   - –°—Ä–µ–¥–Ω–∏–π –¥–∏–∞–ø–∞–∑–æ–Ω —Ü–µ–Ω —É 1980‚Äì1999 –≥–≥. –Ω–µ—Å–∫–æ–ª—å–∫–æ –Ω–∏–∂–µ, —á—Ç–æ –º–æ–∂–µ—Ç –≥–æ–≤–æ—Ä–∏—Ç—å –æ ¬´—Å—Ç–∞–Ω–¥–∞—Ä—Ç–Ω–æ–º¬ª –º–æ—Å–∫–æ–≤—Å–∫–æ–º —Ñ–æ–Ω–¥–µ.

3. **–ü–ª–æ—â–∞–¥—å –∏ —Ü–µ–Ω–∞ –∑–∞ –º¬≤**
   - –ú–µ–¥–∏–∞–Ω–Ω–∞—è —Ü–µ–Ω–∞ –∑–∞ –º–µ—Ç—Ä ‚Äî –æ–∫–æ–ª–æ 94 ‚ÇΩ/–º¬≤; —Å—Ä–µ–¥–Ω—è—è ‚Äî ~108 ‚ÇΩ/–º¬≤.
   - –†–∞—Å–ø—Ä–µ–¥–µ–ª–µ–Ω–∏–µ –∏–º–µ–µ—Ç –ø—Ä–∞–≤—ã–π ¬´—Ö–≤–æ—Å—Ç¬ª: –µ—Å—Ç—å –∫–≤–∞—Ä—Ç–∏—Ä—ã —Å —ç–∫—Å—Ç—Ä–µ–º–∞–ª—å–Ω–æ –≤—ã—Å–æ–∫–æ–π —Å—Ç–∞–≤–∫–æ–π –∑–∞ –º–µ—Ç—Ä.
   - –ê–Ω–∞–ª–∏–∑ —Ü–µ–Ω—ã –∑–∞ –º¬≤ –ø–æ–º–æ–≥–∞–µ—Ç –≤—ã—è–≤–ª—è—Ç—å –æ–±—ä–µ–∫—Ç—ã-–ø–µ—Ä–µ–æ—Ü–µ–Ω–∫–∏ –Ω–µ–∑–∞–≤–∏—Å–∏–º–æ –æ—Ç –æ–±—â–µ–π –ø–ª–æ—â–∞–¥–∏.

4. **–í–∞–∂–Ω–æ—Å—Ç—å –∫–∞—á–µ—Å—Ç–≤–µ–Ω–Ω—ã—Ö –ø—Ä–∏–∑–Ω–∞–∫–æ–≤**
   - –¢–∏–ø —Å–∞–Ω—É–∑–ª–∞, –æ—Ç–¥–µ–ª–∫–∞, –Ω–∞–ª–∏—á–∏–µ —É–¥–æ–±—Å—Ç–≤ (–ø–æ—Å—É–¥–æ–º–æ–π–∫–∞, –∫–æ–Ω–¥–∏—Ü–∏–æ–Ω–µ—Ä, –Ω–µ—Å–∫–æ–ª—å–∫–æ —Å–∞–Ω—É–∑–ª–æ–≤) –¥–æ–±–∞–≤–ª—è—é—Ç –∫ —Ü–µ–Ω–µ.
   - –ü—Ä–µ–¥–æ–ø–ª–∞—Ç–∞, –æ—Ç—Å—É—Ç—Å—Ç–≤–∏–µ —Ç–æ—Ä–≥–∞ –∏ –∫–æ–º–∏—Å—Å–∏—è –≤–ª–∏—è—é—Ç –Ω–∞ —Å–µ–≥–º–µ–Ω—Ç–∞—Ü–∏—é –∏ –¥–∏—Å—Ü–∏–ø–ª–∏–Ω–∏—Ä—É—é—Ç —Ä—ã–Ω–æ–∫.

5. **–í—ã–±—Ä–æ—Å—ã –∏ –∞–Ω–æ–º–∞–ª–∏–∏**
   - –í–æ –≤—Å–µ—Ö —á–∏—Å–ª–æ–≤—ã—Ö —Ö–∞—Ä–∞–∫—Ç–µ—Ä–∏—Å—Ç–∏–∫–∞—Ö (—Ü–µ–Ω–∞, –ø–ª–æ—â–∞–¥—å, —ç—Ç–∞–∂–Ω–æ—Å—Ç—å, –≤—ã—Å–æ—Ç–∞ –ø–æ—Ç–æ–ª–∫–æ–≤) –µ—Å—Ç—å –≤—ã–±—Ä–æ—Å—ã, —Ç—Ä–µ–±—É—é—â–∏–µ –≤–Ω–∏–º–∞–Ω–∏—è –ø—Ä–∏ –º–æ–¥–µ–ª–∏—Ä–æ–≤–∞–Ω–∏–∏.
   - –ù–∞—Ö–æ–¥–∫–∞ —Å–∞–º–æ–π –º–∞–ª–µ–Ω—å–∫–æ–π (15 –º¬≤) –∏ —Å–∞–º–æ–π –¥–æ—Ä–æ–≥–æ–π –∑–∞ –º–µ—Ç—Ä (466 ‚ÇΩ/–º¬≤) –∫–≤–∞—Ä—Ç–∏—Ä—ã –ø–æ–¥—á—ë—Ä–∫–∏–≤–∞–µ—Ç —Ä–∞–∑—Ä—ã–≤ –≤–Ω—É—Ç—Ä–∏ —Ä—ã–Ω–∫–∞.

6. **–†–µ–∫–æ–º–µ–Ω–¥–∞—Ü–∏–∏**
   - –ü—Ä–∏ –ø–æ—Å—Ç—Ä–æ–µ–Ω–∏–∏ –º–æ–¥–µ–ª–µ–π —Ü–µ–Ω–æ–æ–±—Ä–∞–∑–æ–≤–∞–Ω–∏—è —É—á–∏—Ç—ã–≤–∞—Ç—å –≥–µ–æ–ø—Ä–∏–∑–Ω–∞–∫–∏ –∫–∞–∫ –æ—Å–Ω–æ–≤–Ω—ã–µ —Ñ–∏—á–∏.
   - –û—Ç–¥–µ–ª—å–Ω–æ –æ–±—Ä–∞–±–æ—Ç–∞—Ç—å –≤—ã–±—Ä–æ—Å—ã –∏–ª–∏ –ø—Ä–∏–º–µ–Ω—è—Ç—å robust-–º–µ—Ç–æ–¥—ã (–Ω–∞–ø—Ä–∏–º–µ—Ä, –º–æ–¥–µ–ª–∏ —Å L1-—Ä–µ–≥—É–ª—è—Ä–∏–∑–∞—Ü–∏–µ–π).

---

**–ó–∞–∫–ª—é—á–µ–Ω–∏–µ:**
–†—ã–Ω–æ–∫ –ø–æ—Å—É—Ç–æ—á–Ω–æ–π –∞—Ä–µ–Ω–¥—ã –≤ –ú–æ—Å–∫–≤–µ —á—ë—Ç–∫–æ —Å–µ–≥–º–µ–Ω—Ç–∏—Ä–æ–≤–∞–Ω –ø–æ –ª–æ–∫–∞—Ü–∏–∏ –∏ –∫–∞—á–µ—Å—Ç–≤—É –Ω–µ–¥–≤–∏–∂–∏–º–æ—Å—Ç–∏. –î–ª—è –ø—Ä–æ–≥–Ω–æ–∑–∞ —Ü–µ–Ω—ã –∫–ª—é—á–µ–≤—ã–º–∏ —è–≤–ª—è—é—Ç—Å—è –ø—Ä–∏–∑–Ω–∞–∫–∏ ¬´–≥–¥–µ¬ª (–º–µ—Ç—Ä–æ, –∞–¥—Ä–µ—Å) –∏ ¬´–≤ —á—ë–º¬ª (–≥–æ–¥ –ø–æ—Å—Ç—Ä–æ–π–∫–∏, –æ—Ç–¥–µ–ª–∫–∞, —É–¥–æ–±—Å—Ç–≤–∞), –∞ —á–∏—Å—Ç–æ –∫–æ–ª–∏—á–µ—Å—Ç–≤–µ–Ω–Ω—ã–µ –º–µ—Ç—Ä–∏–∫–∏ (–ø–ª–æ—â–∞–¥—å, —ç—Ç–∞–∂) –≤—ã—Å—Ç—É–ø–∞—é—Ç –≤—Ç–æ—Ä–æ—Å—Ç–µ–ø–µ–Ω–Ω—ã–º–∏. –¢–∞–∫–æ–π –∫–æ–º–ø–ª–µ–∫—Å–Ω—ã–π –ø–æ–¥—Ö–æ–¥ –ø–æ–∑–≤–æ–ª—è–µ—Ç –≤—ã—è–≤–∏—Ç—å –∫–∞–∫ —Ç–∏–ø–æ–≤—ã–µ –ø—Ä–µ–¥–ª–æ–∂–µ–Ω–∏—è, —Ç–∞–∫ –∏ –∞–Ω–æ–º–∞–ª—å–Ω–æ –¥–æ—Ä–æ–≥–∏–µ –æ–±—ä–µ–∫—Ç—ã, —á—Ç–æ –æ—Å–æ–±–µ–Ω–Ω–æ –≤–∞–∂–Ω–æ –¥–ª—è –∞–Ω–∞–ª–∏—Ç–∏–∫–æ–≤, —Ä–∏—ç–ª—Ç–æ—Ä–æ–≤ –∏ –∏–Ω–≤–µ—Å—Ç–æ—Ä–æ–≤.

# –û–±—Å—É–∂–¥–µ–Ω–∏–µ
## –ß—Ç–æ –º—ã –ø–ª–∞–Ω–∏—Ä–æ–≤–∞–ª–∏ —Å–¥–µ–ª–∞—Ç—å –∏ —á—Ç–æ —É–¥–∞–ª–æ—Å—å —Ä–µ–∞–ª–∏–∑–æ–≤–∞—Ç—å

–¶–µ–ª—å—é –∏—Å—Å–ª–µ–¥–æ–≤–∞–Ω–∏—è –±—ã–ª –∞–Ω–∞–ª–∏–∑ —Ä—ã–Ω–∫–∞ **–ø–æ—Å—É—Ç–æ—á–Ω–æ–π –∞—Ä–µ–Ω–¥—ã –∫–≤–∞—Ä—Ç–∏—Ä –≤ –ú–æ—Å–∫–≤–µ** —Å —Ñ–æ–∫—É—Å–æ–º –Ω–∞ —Ñ–∞–∫—Ç–æ—Ä—ã, –≤–ª–∏—è—é—â–∏–µ –Ω–∞ —Ü–µ–Ω—É. –ú—ã —Ö–æ—Ç–µ–ª–∏ –≤—ã—è–≤–∏—Ç—å:

- –æ—Å–Ω–æ–≤–Ω—ã–µ –¥—Ä–∞–π–≤–µ—Ä—ã —Å—Ç–æ–∏–º–æ—Å—Ç–∏ –∞—Ä–µ–Ω–¥—ã;
- –≤–ª–∏—è–Ω–∏–µ –¥–∞—Ç—ã –ø–æ—Å—Ç—Ä–æ–π–∫–∏, –≥–µ–æ–ø–æ–∑–∏—Ü–∏–∏, –æ—Ç–¥–µ–ª–∫–∏ –∏ —É–¥–æ–±—Å—Ç–≤;
- –∫—Ä–∞–π–Ω–∏–µ –∏ –Ω–µ—Ç–∏–ø–∏—á–Ω—ã–µ —Å–ª—É—á–∞–∏ (–Ω–∞–ø—Ä–∏–º–µ—Ä, –ø–µ—Ä–µ–æ—Ü–µ–Ω—ë–Ω–Ω—ã–µ –º–∞–ª–æ–≥–∞–±–∞—Ä–∏—Ç–Ω—ã–µ –∫–≤–∞—Ä—Ç–∏—Ä—ã).

–£–¥–∞–ª–æ—Å—å —Ä–µ–∞–ª–∏–∑–æ–≤–∞—Ç—å –ø–æ–ª–Ω—ã–π —Ü–∏–∫–ª:

- –ø—Ä–æ–≤–µ—Å—Ç–∏ –æ—á–∏—Å—Ç–∫—É –¥–∞–Ω–Ω—ã—Ö –∏ –∏–∑–≤–ª–µ—á—å –ø—Ä–∏–∑–Ω–∞–∫–∏ –∏–∑ –ø–æ–ª—É—Å—Ç—Ä—É–∫—Ç—É—Ä–∏—Ä–æ–≤–∞–Ω–Ω—ã—Ö —Å–ø–∏—Å–∫–æ–≤;
- –æ–±–æ–≥–∞—Ç–∏—Ç—å –¥–∞—Ç–∞—Å–µ—Ç –ø—Ä–æ–∏–∑–≤–æ–¥–Ω—ã–º–∏ –ø—Ä–∏–∑–Ω–∞–∫–∞–º–∏ (`price_per_sqm`, `kitchen_ratio` –∏ –¥—Ä.);
- –ø—Ä–æ–∞–Ω–∞–ª–∏–∑–∏—Ä–æ–≤–∞—Ç—å —Ä–∞—Å–ø—Ä–µ–¥–µ–ª–µ–Ω–∏—è, –≤—ã–±—Ä–æ—Å—ã, –∫–∞—Ç–µ–≥–æ—Ä–∏–∞–ª—å–Ω—ã–µ –∏ —Å–ø–∏—Å–∫–æ–≤—ã–µ –ø—Ä–∏–∑–Ω–∞–∫–∏;
- –≤–∏–∑—É–∞–ª–∏–∑–∏—Ä–æ–≤–∞—Ç—å –∑–∞–∫–æ–Ω–æ–º–µ—Ä–Ω–æ—Å—Ç–∏ –ø–æ –≥–µ–æ–≥—Ä–∞—Ñ–∏–∏ (`metro`, `address`) –∏ —ç–ø–æ—Ö–∞–º –ø–æ—Å—Ç—Ä–æ–π–∫–∏;
- –Ω–∞–π—Ç–∏ —è–≤–Ω—ã–µ –∞–Ω–æ–º–∞–ª–∏–∏ –∏ –æ–ø–∏—Å–∞—Ç—å —Å–µ–≥–º–µ–Ω—Ç—ã.

---

## –ß—Ç–æ –Ω–µ —É–¥–∞–ª–æ—Å—å –∏ –ø–æ—á–µ–º—É

- –ú—ã –Ω–µ –ø—Ä–æ–≤–µ–ª–∏ **–º–æ–¥–µ–ª–∏—Ä–æ–≤–∞–Ω–∏–µ (ML)** ‚Äî —ç—Ç–æ –±—ã–ª–æ –≤–Ω–µ —Ñ–æ–∫—É—Å–∞ —Ç–µ–∫—É—â–µ–π –∏—Ç–µ—Ä–∞—Ü–∏–∏, —á—Ç–æ–±—ã –Ω–µ –∂–µ—Ä—Ç–≤–æ–≤–∞—Ç—å –∫–∞—á–µ—Å—Ç–≤–æ–º EDA –∏ –∏–Ω—Ç–µ—Ä–ø—Ä–µ—Ç–∞—Ü–∏–µ–π.
- –ù–µ –≤—Å–µ –ø—Ä–∏–∑–Ω–∞–∫–∏ –≤ `amenities` –∏ `building_info` –º–æ–∂–Ω–æ –±—ã–ª–æ –∏–Ω—Ç–µ—Ä–ø—Ä–µ—Ç–∏—Ä–æ–≤–∞—Ç—å –æ–¥–Ω–æ–∑–Ω–∞—á–Ω–æ ‚Äî –æ–Ω–∏ —Å–∏–ª—å–Ω–æ –≤–∞—Ä—å–∏—Ä—É—é—Ç—Å—è –ø–æ —Ñ–æ—Ä–º–∞—Ç—É (–≤ —Ç.—á. –≤—Ä—É—á–Ω—É—é –≤–≤–µ–¥—ë–Ω–Ω—ã–µ —Å—Ç—Ä–æ–∫–∏).
- –ù–µ —Ä–µ–∞–ª–∏–∑–æ–≤–∞–Ω–∞ –≥–µ–æ–≤–∏–∑—É–∞–ª–∏–∑–∞—Ü–∏—è (–Ω–∞ –∫–∞—Ä—Ç–µ) ‚Äî –≤ –¥–∞–Ω–Ω—ã—Ö –Ω–µ—Ç –∫–æ–æ—Ä–¥–∏–Ω–∞—Ç, —Ç–æ–ª—å–∫–æ —Å—Ç—Ä–æ–∫–∏ –∞–¥—Ä–µ—Å–æ–≤. –≠—Ç–æ —É—Å–ª–æ–∂–Ω—è–µ—Ç –∏—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏–µ `folium`, `mapbox` –∏ —Ç.–¥.

---

## –ö–∞–∫ –º–æ–∂–Ω–æ –±—ã–ª–æ –±—ã —É–ª—É—á—à–∏—Ç—å –∏—Å—Å–ª–µ–¥–æ–≤–∞–Ω–∏–µ

- –î–æ–±–∞–≤–∏—Ç—å **–≥–µ–æ–∫–æ–¥–∏—Ä–æ–≤–∞–Ω–∏–µ** –∞–¥—Ä–µ—Å–æ–≤ –∏ –≤–∏–∑—É–∞–ª–∏–∑–∏—Ä–æ–≤–∞—Ç—å —Å–ø—Ä–æ—Å/—Ü–µ–Ω—É –Ω–∞ –∫–∞—Ä—Ç–µ –ú–æ—Å–∫–≤—ã.
- –ü–æ—Å—Ç—Ä–æ–∏—Ç—å –º–æ–¥–µ–ª—å (–ª–∏–Ω–µ–π–Ω—É—é —Ä–µ–≥—Ä–µ—Å—Å–∏—é, XGBoost) –¥–ª—è –æ—Ü–µ–Ω–∫–∏ –≤–∞–∂–Ω–æ—Å—Ç–∏ —Ñ–∞–∫—Ç–æ—Ä–æ–≤ –∏ –ø—Ä–æ–≥–Ω–æ–∑–∞ —Ü–µ–Ω—ã.
- –ü—Ä–æ–≤–µ—Å—Ç–∏ –∫–ª–∞—Å—Ç–µ—Ä–∏–∑–∞—Ü–∏—é –∫–≤–∞—Ä—Ç–∏—Ä –ø–æ –ø—Ä–∏–∑–Ω–∞–∫–∞–º (–Ω–∞–ø—Ä–∏–º–µ—Ä, "–¥–µ—à—ë–≤—ã–µ —Å—Ç—É–¥–∏–∏", "–¥–æ—Ä–æ–≥–∏–µ —ç–ª–∏—Ç–∫–∏").
- –î–æ–±–∞–≤–∏—Ç—å –≤—Ä–µ–º–µ–Ω–Ω–æ–π –∞–Ω–∞–ª–∏–∑ (–µ—Å–ª–∏ –µ—Å—Ç—å –¥–∞—Ç—ã –ø—É–±–ª–∏–∫–∞—Ü–∏–∏) ‚Äî —Å–µ–∑–æ–Ω–Ω–æ—Å—Ç—å, –¥–∏–Ω–∞–º–∏–∫—É.
- –ò–Ω—Ç–µ–≥—Ä–∞—Ü–∏—è —Å –≤–Ω–µ—à–Ω–∏–º–∏ –∏—Å—Ç–æ—á–Ω–∏–∫–∞–º–∏: –ø–ª–æ—Ç–Ω–æ—Å—Ç—å –∑–∞—Å—Ç—Ä–æ–π–∫–∏, –∏–Ω—Ñ—Ä–∞—Å—Ç—Ä—É–∫—Ç—É—Ä–∞, —Ç—Ä–∞–Ω—Å–ø–æ—Ä—Ç–Ω–∞—è –¥–æ—Å—Ç—É–ø–Ω–æ—Å—Ç—å.

---

## –ö–æ–º—É —ç—Ç–æ –º–æ–∂–µ—Ç –±—ã—Ç—å –ø–æ–ª–µ–∑–Ω–æ

- **–ü–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è–º –∏ –∞—Ä–µ–Ω–¥–∞—Ç–æ—Ä–∞–º** ‚Äî —á—Ç–æ–±—ã –ø–æ–Ω–∏–º–∞—Ç—å, –∑–∞ —á—Ç–æ –æ–Ω–∏ –ø–ª–∞—Ç—è—Ç, –∏ –∫–∞–∫ –Ω–∞—Ö–æ–¥–∏—Ç—å —Ä–∞–∑—É–º–Ω—ã–µ –ø—Ä–µ–¥–ª–æ–∂–µ–Ω–∏—è.
- **–°–æ–±—Å—Ç–≤–µ–Ω–Ω–∏–∫–∞–º –∏ –∞–≥–µ–Ω—Ç—Å—Ç–≤–∞–º** ‚Äî –¥–ª—è –æ–±–æ—Å–Ω–æ–≤–∞–Ω–Ω–æ–≥–æ —Ü–µ–Ω–æ–æ–±—Ä–∞–∑–æ–≤–∞–Ω–∏—è –∏ —Å–µ–≥–º–µ–Ω—Ç–∞—Ü–∏–∏ –æ–±—ä–µ–∫—Ç–æ–≤.
- **–ü–ª–∞—Ç—Ñ–æ—Ä–º–∞–º –∞—Ä–µ–Ω–¥—ã** ‚Äî –∫–∞–∫ —á–∞—Å—Ç—å —Ä–µ–∫–æ–º–µ–Ω–¥–∞—Ç–µ–ª—å–Ω—ã—Ö —Å–∏—Å—Ç–µ–º –∏–ª–∏ —Ñ–∏–ª—å—Ç—Ä–æ–≤ (–Ω–∞–ø—Ä–∏–º–µ—Ä, "–ø–µ—Ä–µ–æ—Ü–µ–Ω–µ–Ω–æ", "–ª—É—á—à–µ–µ —Å–æ–æ—Ç–Ω–æ—à–µ–Ω–∏–µ —Ü–µ–Ω–∞/–ø–ª–æ—â–∞–¥—å").
- **Data science-—Å–ø–µ—Ü–∏–∞–ª–∏—Å—Ç–∞–º** ‚Äî –∫–∞–∫ –ø—Ä–∏–º–µ—Ä –ø–æ–¥–≥–æ—Ç–æ–≤–∫–∏ –∏ –∞–Ω–∞–ª–∏–∑–∞ –ø–æ–ª—É—Å—Ç—Ä—É–∫—Ç—É—Ä–∏—Ä–æ–≤–∞–Ω–Ω—ã—Ö –¥–∞–Ω–Ω—ã—Ö —Å –º–Ω–æ–∂–µ—Å—Ç–≤–æ–º –∫–∞—Ç–µ–≥–æ—Ä–∏–∞–ª—å–Ω—ã—Ö –∏ —Å–ø–∏—Å–∫–æ–≤—ã—Ö –ø—Ä–∏–∑–Ω–∞–∫–æ–≤.

–õ–æ–≥–∏–∫–∞ –∏ –∏–Ω—Å—Ç—Ä—É–º–µ–Ω—Ç—ã –∏—Å—Å–ª–µ–¥–æ–≤–∞–Ω–∏—è –ø–µ—Ä–µ–Ω–æ—Å–∏–º—ã: –µ—Å–ª–∏ –≤–º–µ—Å—Ç–æ –∞—Ä–µ–Ω–¥—ã –∫–≤–∞—Ä—Ç–∏—Ä —É –Ω–∞—Å –±—ã–ª –±—ã –∞–Ω–∞–ª–∏–∑ –≥–æ—Å—Ç–∏–Ω–∏—Ü, —Ä–µ—Ü–µ–ø—Ç–æ–≤, –≤–∞–∫–∞–Ω—Å–∏–π –∏–ª–∏ –∞–≤—Ç–æ–º–æ–±–∏–ª–µ–π ‚Äî –ø–æ–¥—Ö–æ–¥ –æ—Å—Ç–∞–ª—Å—è –±—ã —Ç–µ–º –∂–µ. –ì–ª–∞–≤–Ω–æ–µ ‚Äî –∏–∑–≤–ª–µ—á–µ–Ω–∏–µ, –Ω–æ—Ä–º–∞–ª–∏–∑–∞—Ü–∏—è, –æ–±–æ–≥–∞—â–µ–Ω–∏–µ –ø—Ä–∏–∑–Ω–∞–∫–æ–≤ –∏ –∏–Ω—Ç–µ—Ä–ø—Ä–µ—Ç–∞—Ü–∏—è.
    """)
